<!doctype html>
<html>
    <head>
        <title>HTML Clean/Strip</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <h4>Content:</h4>
        <div id="editor" contenteditable>
        </div>
        <div>
            <button id="clearButton">clear</button>
        </div>
        <h4>HTML</h4>
        <div id="html">
        </div>
    </body>
    <script>
     'use strict';
     var AzDomStripper = {
         /**
          *
          */
         defaultConfig: {
             elementsToRemove: ['script', 'form', 'iframe'],
             attributesToRetain: {
                 genrc: [/*'id',*/ 'href', 'src', 'alt'],
                 audio: ['class', 'src', 'controls', 'controlslist', 'preload'],
                 video: ['class', 'src', 'controls', 'controlslist', 'preload'],
                 img: ['src', 'alt', 'width', 'height', 'title'],
                 div: ['id']
             }
         },
         /**
          *
          */
         removeElements: function(host, config) {
             Array.prototype.slice.call(config.elementsToRemove || ['script'])
                  .map(function(el) {
                      return Array.prototype.slice.call(host.querySelectorAll(el));
                  })
                  .reduce(function(acc, next) {
                      return acc.concat(next);
                  })
                  .forEach(function(it) {
                      it.remove();
                  });
         },
         /**
          *
          */
         removeAttributes: function(host, config) {
             Array.prototype.slice.call(host.querySelectorAll('*'))
                  .forEach(function(el) {
                      var removeElementAttributeP = function(at) {
                          var atr = config.attributesToRetain[el.localName];
                          if (atr && atr.includes(at.name)) {
                          } else {
                              return !(config.attributesToRetain['genrc'] || []).includes(at.name);
                          }
                      };
                      Array.prototype.slice.call(el.attributes)
                           .filter(removeElementAttributeP)
                           .forEach(function(at) {
                               el.removeAttribute(at.name);
                           });
                  });
         }
     };
     window.AzDomStripper = AzDomStripper;
     window.addEventListener('load', () => {
         //
         editor.addEventListener('input', e => {
             html.innerText = editor.innerHTML;
         });
         //
         clearButton.onclick = (e) => {
             let newNode = document.createElement('div');
             newNode.innerHTML = editor.innerHTML;
             AzDomStripper.removeElements(newNode, AzDomStripper.defaultConfig);
             AzDomStripper.removeAttributes(newNode, AzDomStripper.defaultConfig);
             editor.innerHTML = newNode.innerHTML;
             html.innerText = editor.innerHTML;
         };
     });
    </script>
</html>
